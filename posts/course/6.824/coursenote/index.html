<!doctype html><html lang=zh-Hans x-data :class=$store.darkMode.class() :data-theme=$store.darkMode.theme()><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Coursenote | Askyx's Blog</title><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>ğŸŒ±</text></svg>"></link>
<link rel=canonical href=https://askyx.github.io/posts/course/6.824/coursenote/><meta name=author content="Askyx"><meta name=description content="éšå ‚ç¬”è®° Why do people build distributed systems? to increase capacity via parallel processing to tolerate faults via replication to match distribution of physical devices e.g. sensors to achieve security via isolation
åˆ†å¸ƒå¼çš„å›°éš¾ç‚¹ï¼š
å¤§é‡çš„å¹¶å‘æ“ä½œ å…·æœ‰å®¹é”™æ€§ éš¾äºå®ç° Lab 1: distributed big-data framework (like MapReduce) Lab 2: fault tolerance library using replication (Raft) Lab 3: a simple fault-tolerant database Lab 4: scalable database performance via sharding
"><meta name=keywords content><meta name=generator content="Hugo 0.152.2"><meta property="og:url" content="https://askyx.github.io/posts/course/6.824/coursenote/"><meta property="og:site_name" content="Askyx's Blog"><meta property="og:title" content="Coursenote"><meta property="og:description" content="éšå ‚ç¬”è®° Why do people build distributed systems? to increase capacity via parallel processing to tolerate faults via replication to match distribution of physical devices e.g. sensors to achieve security via isolation
åˆ†å¸ƒå¼çš„å›°éš¾ç‚¹ï¼š
å¤§é‡çš„å¹¶å‘æ“ä½œ å…·æœ‰å®¹é”™æ€§ éš¾äºå®ç° Lab 1: distributed big-data framework (like MapReduce) Lab 2: fault tolerance library using replication (Raft) Lab 3: a simple fault-tolerant database Lab 4: scalable database performance via sharding"><meta property="og:locale" content="zh_Hans"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-17T13:17:04+08:00"><meta property="article:modified_time" content="2025-11-06T15:45:31+08:00"><meta property="og:image" content="https://askyx.github.io/img/global-background.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://askyx.github.io/img/global-background.jpg"><meta name=twitter:title content="Coursenote"><meta name=twitter:description content="éšå ‚ç¬”è®° Why do people build distributed systems? to increase capacity via parallel processing to tolerate faults via replication to match distribution of physical devices e.g. sensors to achieve security via isolation
åˆ†å¸ƒå¼çš„å›°éš¾ç‚¹ï¼š
å¤§é‡çš„å¹¶å‘æ“ä½œ å…·æœ‰å®¹é”™æ€§ éš¾äºå®ç° Lab 1: distributed big-data framework (like MapReduce) Lab 2: fault tolerance library using replication (Raft) Lab 3: a simple fault-tolerant database Lab 4: scalable database performance via sharding"><link rel=stylesheet href=/css/output.min.css><style>pre{padding:1em;overflow:auto}</style><link rel=stylesheet href=/css/custom.css><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin=anonymous></script></head><body x-data="{
    flip: false,
  }"><div id=dream-global-bg></div><nav x-data="{ isSticky: false }" x-init="window.addEventListener('scroll', () => { isSticky = window.scrollY > 30 })" class="sticky top-0 z-30 mt-4 lg:mt-8 py-4" :class="{ 'bg-base-100 shadow-lg dark:border-b dark:border-base-content/30': isSticky }"><div class="container flex justify-between px-4"><section class="flex items-center gap-4"><div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title="Flip it!"><div class="h-10 rounded-full"><img src=/img/personal/avatar.jpg alt="Askyx's Blog"></div></div><div><a href=https://askyx.github.io/ class="text-lg font-semibold cursor-pointer">Askyx's Blog</a><div class="text-base-content/60 text-sm">life is short, use Python</div></div></section><div class="dropdown dropdown-end sm:hidden"><div tabindex=0 role=button class="btn btn-ghost btn-square" aria-label="Select an option"><ion-icon name=menu class=text-2xl></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md"><li><div role=link tabindex=0 class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title=About><ion-icon name=information-circle></ion-icon>About</div></li><li><a class="group inline-flex items-center p-2 cursor-pointer" href=/search title=Search><ion-icon name=search></ion-icon>Search</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=https://github.com/askyx target=_blank title=GitHub><ion-icon name=logo-github></ion-icon>GitHub</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=Archives><ion-icon name=archive></ion-icon>Archives</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title="All Tags"><ion-icon name=pricetags></ion-icon>All Tags</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li></ul></div><section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4"><div role=link tabindex=0 class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title=About>About</div><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=/search title=Search><ion-icon class=group-hover:text-primary-content name=search></ion-icon></a><a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href=https://github.com/askyx target=_blank title=GitHub><ion-icon class=group-hover:text-primary-content name=logo-github></ion-icon></a><div class="dropdown dropdown-end dropdown-hover"><div tabindex=0 role=button class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" aria-label="Select an option"><ion-icon class="group-hover:text-primary-content text-xl" name=menu></ion-icon></div><ul tabindex=0 class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-xl"><li><a class="inline-flex items-center p-2 cursor-pointer" href=/posts title=Archives><ion-icon name=archive></ion-icon>Archives</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/tags title="All Tags"><ion-icon name=pricetags></ion-icon>All Tags</a></li><li><a class="inline-flex items-center p-2 cursor-pointer" href=/index.xml title=RSS><ion-icon name=logo-rss></ion-icon>RSS</a></li></ul></div></section></div></nav><div class=flip-container :class="{ 'flip-it': flip }"><div class=flipper><div class=front><div class=container><div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4"><div class="hidden lg:block"></div><div class=lg:col-span-2><article class="mx-auto prose prose-quoteless dark:prose-invert" id=dream-single-post-main itemscope itemtype=http://schema.org/Article><meta itemprop=name content="Coursenote"><meta itemprop=description content="éšå ‚ç¬”è®° Why do people build distributed systems? to increase capacity via parallel processing to tolerate faults via replication to match distribution of physical devices e.g. sensors to achieve security via isolation
åˆ†å¸ƒå¼çš„å›°éš¾ç‚¹ï¼š
å¤§é‡çš„å¹¶å‘æ“ä½œ å…·æœ‰å®¹é”™æ€§ éš¾äºå®ç° Lab 1: distributed big-data framework (like MapReduce) Lab 2: fault tolerance library using replication (Raft) Lab 3: a simple fault-tolerant database Lab 4: scalable database performance via sharding"><meta itemprop=datePublished content="2022-05-17T13:17:04+08:00"><meta itemprop=dateModified content="2025-11-06T15:45:31+08:00"><meta itemprop=wordCount content="647"><meta itemprop=image content="https://askyx.github.io/img/global-background.jpg"><header><h1 itemprop=headline>Coursenote</h1><p class=text-sm><span data-format=luxon>2022-05-17T13:17:04+08:00</span>
| <span>2 minute read</span>
| <span>Updated at
<span data-format=luxon>2025-11-06T15:45:31+08:00</span></span></p></header><section id=dream-single-post-content itemprop=articleBody><h2 id=éšå ‚ç¬”è®°>éšå ‚ç¬”è®°</h2><p>Why do people build distributed systems?
to increase capacity via parallel processing
to tolerate faults via replication
to match distribution of physical devices e.g. sensors
to achieve security via isolation</p><p>åˆ†å¸ƒå¼çš„å›°éš¾ç‚¹ï¼š</p><ol><li>å¤§é‡çš„å¹¶å‘æ“ä½œ</li><li>å…·æœ‰å®¹é”™æ€§</li><li>éš¾äºå®ç°</li></ol><p>Lab 1: distributed big-data framework (like MapReduce)
Lab 2: fault tolerance library using replication (Raft)
Lab 3: a simple fault-tolerant database
Lab 4: scalable database performance via sharding</p><p>A big goal: hide the complexity of distribution from applications.</p><p>Topic: fault tolerance
1000s of servers, big network -> always something broken
We&rsquo;d like to hide these failures from the application.<br>&ldquo;High availability&rdquo;: service continues despite failures<br>Big idea: replicated servers.
If one server crashes, can proceed using the other(s).
Labs 2 and 3</p><p>Topic: consistency
General-purpose infrastructure needs well-defined behavior.
E.g. &ldquo;Get(k) yields the value from the most recent Put(k,v).&rdquo;
Achieving good behavior is hard!
&ldquo;Replica&rdquo; servers are hard to keep identical.</p><p>Topic: performance
The goal: scalable throughput
Nx servers -> Nx total throughput via parallel CPU, disk, net.
Scaling gets harder as N grows:
Load imbalance.
Slowest-of-N latency.
Some things don&rsquo;t speed up with N: initialization, interaction.
Labs 1, 4</p><p>Topic: tradeoffs
Fault-tolerance, consistency, and performance are enemies.
Fault tolerance and consistency require communication
e.g., send data to backup
e.g., check if my data is up-to-date
communication is often slow and non-scalable
Many designs provide only weak consistency, to gain speed.
e.g. Get() does <em>not</em> yield the latest Put()!
Painful for application programmers but may be a good trade-off.
We&rsquo;ll see many design points in the consistency/performance spectrum.</p><p>Topic: implementation
RPC, threads, concurrency control, configuration.
The labs&mldr;</p><h2 id=gfs>GFS</h2><p>Why is distributed storage hard?<br>high performance -> shard data over many servers<br>many servers -> constant faults<br>fault tolerance -> replication<br>replication -> potential inconsistencies<br>better consistency -> low performance</p><p>æ˜¯ä¸€ä¸ªé—­ç¯é—®é¢˜ï¼Œé«˜æ€§èƒ½éœ€è¦æ›´å¤šçš„æœºå™¨ï¼Œæ›´å¤šçš„æœºå™¨å¯¼è‡´æ›´é«˜çš„æ•…éšœç‡ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜ä¸€èˆ¬ä½¿ç”¨å¤šå‰¯æœ¬è§£å†³ï¼Œä½†æ˜¯å¤šå‰¯æœ¬åˆå¸¦æ¥ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œè€Œä¸ºäº†æ›´é«˜çš„ä¸€è‡´æ€§ï¼Œåˆä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™</p><h3 id=consistency>consistency</h3><p>åœ¨å•æœºä¸Šï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶å†™ä¸€ä¸ªæ•°æ®ï¼Œæœ€ç»ˆçš„ç»“æœå¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œä½†æ˜¯åç»­æ‰€æœ‰çš„ç”¨æˆ·éƒ½ä¼šå¾—åˆ°åŒä¸€ä¸ªæ•°æ®ï¼Œè¿™æ˜¯å¼ºä¸€è‡´æ€§<br>ä½†æ˜¯åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸Šï¼Œç”¨æˆ·å†™æ•°æ®ï¼Œä¹‹åçš„ç”¨æˆ·åœ¨ä¸åŒçš„æœºå™¨ä¸Šå¾—åˆ°çš„æ•°æ®éœ€è¦çœ‹æ­¤æ—¶é›†ç¾¤çš„ä¸€è‡´æ€§åè®®</p><ul><li>åˆ†å¸ƒå¼çš„æ ¸å¿ƒé—®é¢˜æ˜¯ä¸€è‡´æ€§ä»¥åŠå…¶ä»–é™åˆ¶ä¹‹é—´çš„åšå¼ˆ</li></ul><p>masterè®°å½•æ–‡ä»¶å—çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡ä»¶æ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œæ–‡ä»¶åˆ†ç‰‡ä¿¡æ¯ç­‰<br>serverä¿å­˜æ–‡ä»¶ï¼Œæ–‡ä»¶ä½¿ç”¨3å‰¯æœ¬</p><p>What are the steps when client C wants to read a file?</p><ol><li>C sends filename and offset to coordinator (CO) (if not cached)</li><li>CO finds chunk handle for that offset</li><li>CO replies with list of chunkhandles + chunkservers
only those with latest version</li><li>C caches handle + chunkserver list</li><li>C sends request to nearest chunkserver
chunk handle, offset</li><li>chunk server reads from chunk file on disk, returns to client</li></ol></section><div class=divider></div><div class="flex flex-col md:flex-row justify-between gap-4 py-4"><a role=button class="btn btn-outline h-12" href=/posts/course/6.824/mapreduce/ title=Mapreduce><ion-icon name=chevron-back></ion-icon><div class="inline-flex flex-col items-start"><span class="text-base-content/60 text-xs font-normal">Previous page</span>
<span class="max-w-48 truncate">Mapreduce</span></div></a><a role=button class="btn btn-outline h-12" href=/posts/readbooks/leveldb/ title=LevelDBæºç é˜…è¯»><div class="inline-flex flex-col items-end"><span class="text-base-content/60 text-xs font-normal">Next page</span>
<span class="max-w-48 truncate">LevelDBæºç é˜…è¯»</span></div><ion-icon name=chevron-forward></ion-icon></a></div></article></div><div x-data=tocHighlighter() @scroll.window=debouncedScroll class="hidden lg:flex lg:flex-col lg:items-end lg:self-start"><nav id=TableOfContents><ul><li><a href=#éšå ‚ç¬”è®°>éšå ‚ç¬”è®°</a></li><li><a href=#gfs>GFS</a><ul><li><a href=#consistency>consistency</a></li></ul></li></ul></nav></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>Â© 2016 - 2025 Askyx's Blog</p><p class=text-sm>ğŸŒ±
<span class=text-base-content/60>Powered by <a class=hover:underline href=https://gohugo.io/ target=_blank>Hugo</a> with theme
<a class=hover:underline href=https://github.com/g1eny0ung/hugo-theme-dream target=_blank>Dream</a>.</span></p></div><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div><div class=back><div class=container><div class="dream-grid dream-grid-about"><div class="w-full md:w-1/2 lg:w-1/3 xl:w-1/4 p-4 dream-column"><article class="card bg-base-100 hover:bg-base-content/10 shadow-xl dark:border dark:border-base-content/30"><div class=card-body><div class=card-title>About Me</div><div class="prose dark:prose-invert"><p>This is my blog.</p><h2 id=ãƒ¾Ï‰o>ãƒ¾(â€¢Ï‰â€¢`)o</h2><p>æ¯”è¾ƒèƒ†å°ï¼Œå‡ºé—¨éƒ½å¾—è´´å¢™èµ°</p></div></div></article></div></div><footer class="flex justify-between items-center gap-2 px-4 py-12"><div><p>Â© 2016 - 2025 Askyx's Blog</p><p class=text-sm>ğŸŒ±
<span class=text-base-content/60>Powered by <a class=hover:underline href=https://gohugo.io/ target=_blank>Hugo</a> with theme
<a class=hover:underline href=https://github.com/g1eny0ung/hugo-theme-dream target=_blank>Dream</a>.</span></p></div><div x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }" class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"><template x-for="icon in icons"><div role=button tabindex=0 :aria-label="'Select ' + icon.name + ' mode'" class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary" :class="$store.darkMode.icon() === icon.name && 'bg-primary'" @click=$store.darkMode.toggle(icon.status)><ion-icon :name="`${icon.name}-outline`" class=group-hover:text-primary-content :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"></ion-icon></div></template></div></footer></div></div></div></div><script>window.lightTheme="emerald",window.darkTheme="forest"</script><script src=https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin=anonymous></script><script src=/js/grid.min.js></script><script src=/js/main.min.js></script><script src=https://cdn.jsdelivr.net/npm/luxon@1.26.0 integrity="sha256-4sbTzmCCW9LGrIh5OsN8V5Pfdad1F1MwhLAOyXKnsE0=" crossorigin=anonymous></script><script>format();function format(){document.querySelectorAll('span[data-format="luxon"]').forEach(e=>{const t=e.textContent;e.textContent=luxon.DateTime.fromISO(t,{locale:"en"}).toFormat("yyyyå¹´MMæœˆddæ—¥")})}</script><script src=/js/toc.min.js></script><script type=module>
      import mediumZoom from 'https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/+esm';
      mediumZoom('#dream-single-post-content img', {
        background: 'oklch(var(--b1))',
        margin: 24,
      })
    </script><script type=module src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin=anonymous></script><script nomodule src=https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin=anonymous></script></body></html>