<!doctype html><html lang=en>
<head>
<title>
Postgresæºç ç¼–è¯‘åŠè°ƒè¯• ::
Asky â€” My note blog
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="æºç ç¼–è¯‘ #  ç¯å¢ƒå‡†å¤‡ï¼Œè¿™é‡Œä½¿ç”¨Ubuntu22ï¼Œæ‰§è¡Œå‘½ä»¤sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.listæ›¿æ¢æºï¼Œæ›´æ–°ç³»ç»Ÿ
 æºç ä¸‹è½½ ç›´æ¥ä¸‹è½½æœ€æ–°æºç ï¼Œgithubä¸Šçš„æºç æ¯ä¸€ä¸ªæäº¤éƒ½ä¿è¯æ˜¯å¯ç¼–è¯‘è¿è¡Œçš„  git clone git@github.com:postgres/postgres.git ä¾èµ–å®‰è£…  sudo apt-get -y install flex \ bison \ libreadline-dev \ libssl-dev \ libpam-dev \ libxml2 \ libxml2-dev \ libxslt-dev \ libldap-dev \ libperl-dev \ python3-dev\ zlib1g-dev \ libssh2-1-dev \ gdb \ c++ \ gcc \ make ç¼–è¯‘  ä¸ºäº†èƒ½ä½¿ç”¨gdbè°ƒè¯•ï¼Œéœ€è¦ä½¿ç”¨debugæ¨¡å¼è°ƒè¯•ï¼Œæˆ‘è‡ªå·±ä¹‹å‰ç¼–è¯‘çš„æ—¶å€™å‘ç°å³ä½¿æŒ‡å®š-enable-debugåœ¨ç¼–è¯‘çš„æ—¶å€™å‘ç°ä¹Ÿä½¿ç”¨äº†-O2ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®ç›´æ¥ä¿®æ”¹configureä¸­çš„-Oå’Œ-O2ä¸º-gï¼Œpgçš„æ•°æ®æŒ‡å®š-Dçš„ ä½ç½®ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªç¯å¢ƒä¸­ï¼Œä¸€ä¸ªç¼–è¯‘å‡ºæ¥çš„æ•°æ®åº“å¯ä»¥æœ‰å¤šä¸ªè¿è¡Œç¯å¢ƒï¼Œæˆ–è€…å¯ä»¥æœ‰å¤šä¸ªç¼–è¯‘ç¯å¢ƒï¼Œå¤šä¸ªè¿è¡Œç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æŒ‰éœ€é…ç½®
./configure --enable-depend --enable-cassert --enable-debug --prefix=/home/vscode/build make sudo make install å¯åŠ¨  /home/vscode/build/bin/initdb -D /home/vscode/data /home/vscode/build/bin/pg_ctl -D /home/vscode/data start /home/vscode/build/bin/pg_ctl -D /home/vscode/data stop /home/vscode/build/bin/psql -p 5432  ä½¿ç”¨TASKæ‰§è¡Œ #  å¯ä»¥ç›´æ¥é…ç½®ä¸Šé¢çš„è¯­å¥ä¸ºVSCodeçš„taskï¼Œä¸‹è½½æºç å®‰è£…ä¾èµ–ä¹‹åç›´æ¥run taskå³å¯ç›´æ¥ç¼–è¯‘è¿è¡Œ
// æ›¿æ¢è‡ªå·±çš„è·¯å¾„ { // See https://go.microsoft.com/fwlink/?LinkId=733558  // for the documentation about the tasks.">
<meta name=keywords content="ç¨‹åºå‘˜ã€ç å†œã€databaseã€C++">
<meta name=robots content="noodp">
<link rel=canonical href=https://askyx.github.io/posts/env/>
<link rel=stylesheet href=//cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/lxgwwenkaiscreen.css media=print onload="this.media='all'">
<link rel=stylesheet href=https://askyx.github.io/assets/style.css>
<link rel=stylesheet href=https://askyx.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://askyx.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://askyx.github.io/favicon.ico>
<link rel=apple-touch-icon href=https://askyx.github.io/favicon.ico>
<link rel=bookmark href=https://askyx.github.io/favicon.ico>
<link rel=apple-touch-icon-precomposed sizes=180x180 href=https://askyx.github.io/favicon.ico>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Postgresæºç ç¼–è¯‘åŠè°ƒè¯•">
<meta name=twitter:description content="Postges æºç ç¯å¢ƒæ­å»ºï¼ŒUbuntu22ï¼ŒVSCodeï¼Œdocker">
<meta property="og:title" content="Postgresæºç ç¼–è¯‘åŠè°ƒè¯•">
<meta property="og:description" content="Postges æºç ç¯å¢ƒæ­å»ºï¼ŒUbuntu22ï¼ŒVSCodeï¼Œdocker">
<meta property="og:type" content="article">
<meta property="og:url" content="https://askyx.github.io/posts/env/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-07-20T17:54:05+08:00">
<meta property="article:modified_time" content="2022-07-20T17:54:05+08:00">
</head>
<body class=light-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://askyx.github.io/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Asky</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/about>About</a></li>
<li><a href=/archive>Archive</a></li>
<li><a href=/search>ğŸ”</a></li>
<li><a href=javascript:; onclick=randomPost() title=éšæœºè®¿é—®ä¸€ç¯‡æ–‡ç« ><svg t="1660103436159" class="icon search-box-icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="1184" width="32" height="32"><path d="M421.376 481.28s117.248 24.576 175.104-8.704c0 0-89.6 70.144-89.6 166.4.512-.512-8.192-121.344-85.504-157.696zm17.408 487.936s68.608 6.656 68.608-80.896c0 0 3.072 88.576 65.024 78.336.0.512-50.688 22.016-133.632 2.56zM161.28 238.08s-30.208 65.536 11.264 91.648c0 0-67.072-17.408-81.408 37.376.0.0 8.704-82.944 70.144-129.024zM857.6 227.328s49.152 50.176 1.024 81.408c0 0 58.88-18.432 66.56 36.352.0.0 5.12-69.632-67.584-117.76z" p-id="1185"/><path d="M443.392 970.752c-5.632.0-10.752-1.024-15.36-3.072L157.184 810.496l-1.536-1.024s-1.024-1.024-4.608-2.56c-51.2-29.184-62.976-94.208-65.536-120.832V386.56c0-3.072.512-7.168 1.024-11.264l.512-3.584 1.024-2.56c19.456-50.688 76.8-51.2 103.936-44.032l-1.536 5.632 4.096-6.144L476.16 486.4l18.944 37.888c20.992 36.864 29.184 77.824 32.768 99.84v258.048c-4.608 56.32-36.864 76.288-55.808 82.944-1.024.512-15.36 5.632-28.672 5.632zM181.248 774.656l263.168 152.576c12.288-.512 36.864-6.656 40.448-48.128V628.736c-4.608-31.744-20.992-103.936-72.192-128L322.56 445.44l1.536 3.072L181.76 366.08c-2.048-.512-40.448-9.216-52.736 15.872-.512 2.56-.512 4.608-.512 6.144v294.4c1.536 16.896 9.728 67.072 43.52 86.528 3.584 2.048 6.656 4.096 9.216 5.632z" p-id="1186"/><path d="M837.632 212.992c6.656 4.096 12.8 7.168 18.432 10.752l1.536 1.024 1.536 1.536c5.12 4.096 10.752 9.216 16.384 15.36 6.144 11.776 5.632 33.28 4.608 49.152-1.024 12.288-6.656 30.208-26.624 44.544l-1.024.512-247.808 156.672c-26.624 14.336-62.976 18.432-96.256 18.432-40.96.0-77.824-6.656-89.088-8.704l-3.072-.512-245.248-142.336c-39.424-29.696-28.16-85.504-15.36-113.664l2.56-6.144 263.68-166.912c29.184-14.336 104.448-43.008 173.056-1.024 3.584 2.56 58.368 34.304 119.296 69.632M431.616 460.8c40.448 7.168 114.176 13.824 152.576-6.144L828.928 299.52c7.168-5.632 8.192-10.24 8.704-12.8 1.024-11.264-9.728-26.624-15.36-32.768-55.808-32.256-243.712-141.312-250.368-145.408-49.664-30.72-107.008-9.216-130.048 2.56L192.512 268.8c-4.096 12.288-12.288 42.496 3.584 55.808L431.616 460.8z" p-id="1187"/><path d="M831.488 299.008c4.096-1.024 38.4-11.264 66.048 6.144 7.168 4.608 17.92 11.776 24.064 24.576 1.024 5.632 4.096 10.752 4.608 16.896v2.048l-1.024 323.072c-5.12 35.328-22.528 91.648-77.312 125.44l-5.12 3.584h-1.024L579.584 966.656l-4.608.512c-4.096.512-8.704 1.024-12.8 1.024-15.872.0-30.208-5.12-41.984-14.848-24.576-20.48-32.768-55.808-35.328-73.728l-1.024-252.928h1.536c6.144-96.768 88.576-164.864 96.768-171.008l-.512-.512L829.44 299.52M528.384 867.328c.512 10.24 5.12 41.472 19.968 53.76 3.072 2.56 7.68 5.632 16.384 5.12L829.44 758.272c56.32-38.4 53.76-115.712 53.76-116.224l-.512-32.256 1.024-250.368h-.512c-1.536-12.8-7.168-16.384-8.704-17.408-8.704-5.632-23.552-3.072-28.672-2.048L610.304 488.96c-1.024.512-80.896 65.024-80.896 149.504h-1.536l.512 228.864zM435.2 264.192c0 27.648 31.744 50.176 71.168 50.176s71.168-22.528 71.168-50.176-31.744-50.176-71.168-50.176S435.2 236.544 435.2 264.192z" p-id="1188"/><path d="M663.552 782.848c0 30.72-22.528 67.072-49.664 80.384-27.648 13.824-50.176-.512-50.176-31.232s22.528-67.072 50.176-80.384c27.136-13.824 49.664.0 49.664 31.232zM760.32 602.624c0 30.72-22.528 67.072-49.664 80.384-27.648 13.824-49.664-.512-49.664-31.232s22.528-67.072 49.664-80.384c27.136-13.824 49.664.512 49.664 31.232zM867.84 428.032c0 30.72-22.528 67.072-49.664 80.384C790.528 522.24 768 507.904 768 477.184s22.528-67.072 50.176-80.384c27.136-13.824 49.664.0 49.664 31.232zM270.848 538.112c0 30.72-22.016 41.984-48.64 24.576-27.136-16.896-48.64-55.808-48.64-86.528s22.016-41.984 48.64-24.576c26.624 16.896 48.64 55.808 48.64 86.528zm161.28 285.184c0 30.72-22.016 41.984-48.64 24.576-26.624-17.408-48.64-55.808-48.64-86.528s22.016-41.984 48.64-24.576c26.624 16.896 48.64 55.808 48.64 86.528z" p-id="1189"/></svg></a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/about>About</a></li>
<li><a href=/archive>Archive</a></li>
<li><a href=/search>ğŸ”</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<div class=breadcrumb>
<li>
<a href=https://askyx.github.io/>é¦–é¡µ</a>
</li>
<li>
<a href=https://askyx.github.io/posts/>Posts</a>
</li>
<li class=active>
<a href=https://askyx.github.io/posts/env/>Postgresæºç ç¼–è¯‘åŠè°ƒè¯•</a>
</li>
</div>
<h2 class=post-title><a href=https://askyx.github.io/posts/env/>Postgresæºç ç¼–è¯‘åŠè°ƒè¯•</a></h2>
<div class=post-meta>
<span class=post-date>
2022-07-20
</span>
</div>
<div class=post-content>
<aside class=table-of-contents><nav id=TableOfContents>
<ul>
<li><a href=#æºç ç¼–è¯‘>æºç ç¼–è¯‘</a></li>
<li><a href=#ä½¿ç”¨taskæ‰§è¡Œ>ä½¿ç”¨TASKæ‰§è¡Œ</a></li>
<li><a href=#ä½¿ç”¨vscodeè°ƒè¯•>ä½¿ç”¨VSCodeè°ƒè¯•</a></li>
<li><a href=#ä½¿ç”¨docker>ä½¿ç”¨Docker</a></li>
<li><a href=#åˆ†å¸ƒå¼pg>åˆ†å¸ƒå¼PG</a>
<ul>
<li><a href=#benchmark>benchmark</a></li>
</ul>
</li>
</ul>
</nav></aside>
<h2 id=æºç ç¼–è¯‘>
æºç ç¼–è¯‘
<a href=#%e6%ba%90%e7%a0%81%e7%bc%96%e8%af%91 class=h-anchor aria-hidden=true>#</a>
</h2>
<p>ç¯å¢ƒå‡†å¤‡ï¼Œè¿™é‡Œä½¿ç”¨Ubuntu22ï¼Œæ‰§è¡Œå‘½ä»¤<code>sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list</code>æ›¿æ¢æºï¼Œæ›´æ–°ç³»ç»Ÿ</p>
<ol>
<li>æºç ä¸‹è½½
ç›´æ¥ä¸‹è½½æœ€æ–°æºç ï¼Œgithubä¸Šçš„æºç æ¯ä¸€ä¸ªæäº¤éƒ½ä¿è¯æ˜¯å¯ç¼–è¯‘è¿è¡Œçš„</li>
</ol>
<pre tabindex=0><code>git clone git@github.com:postgres/postgres.git
</code></pre><ol start=2>
<li>ä¾èµ–å®‰è£…</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++>sudo apt<span style=color:#f92672>-</span>get <span style=color:#f92672>-</span>y install flex \
   bison \
   libreadline<span style=color:#f92672>-</span>dev \
   libssl<span style=color:#f92672>-</span>dev \
   libpam<span style=color:#f92672>-</span>dev \
   libxml2 \
   libxml2<span style=color:#f92672>-</span>dev \
   libxslt<span style=color:#f92672>-</span>dev \
   libldap<span style=color:#f92672>-</span>dev \
   libperl<span style=color:#f92672>-</span>dev \
   python3<span style=color:#f92672>-</span>dev\
   zlib1g<span style=color:#f92672>-</span>dev \
   libssh2<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>dev \
   gdb \
   c<span style=color:#f92672>++</span> \
   gcc \
   make
</code></pre></div><ol start=3>
<li>ç¼–è¯‘</li>
</ol>
<p>ä¸ºäº†èƒ½ä½¿ç”¨gdbè°ƒè¯•ï¼Œéœ€è¦ä½¿ç”¨debugæ¨¡å¼è°ƒè¯•ï¼Œæˆ‘è‡ªå·±ä¹‹å‰ç¼–è¯‘çš„æ—¶å€™å‘ç°å³ä½¿æŒ‡å®š<code>-enable-debug</code>åœ¨ç¼–è¯‘çš„æ—¶å€™å‘ç°ä¹Ÿä½¿ç”¨äº†<code>-O2</code>ï¼Œæ‰€ä»¥è¿™é‡Œå»ºè®®ç›´æ¥ä¿®æ”¹<code>configure</code>ä¸­çš„<code>-O</code>å’Œ<code>-O2</code>ä¸º<code>-g</code>ï¼Œpgçš„æ•°æ®æŒ‡å®š-Dçš„
ä½ç½®ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªç¯å¢ƒä¸­ï¼Œä¸€ä¸ªç¼–è¯‘å‡ºæ¥çš„æ•°æ®åº“å¯ä»¥æœ‰å¤šä¸ªè¿è¡Œç¯å¢ƒï¼Œæˆ–è€…å¯ä»¥æœ‰å¤šä¸ªç¼–è¯‘ç¯å¢ƒï¼Œå¤šä¸ªè¿è¡Œç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æŒ‰éœ€é…ç½®</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>./configure --enable-depend --enable-cassert --enable-debug --prefix<span style=color:#f92672>=</span>/home/vscode/build

make

sudo make install
</code></pre></div><ol start=4>
<li>å¯åŠ¨</li>
</ol>
<pre tabindex=0><code>/home/vscode/build/bin/initdb -D /home/vscode/data 
/home/vscode/build/bin/pg_ctl -D /home/vscode/data  start
/home/vscode/build/bin/pg_ctl -D /home/vscode/data  stop
/home/vscode/build/bin/psql -p 5432
</code></pre><hr>
<h2 id=ä½¿ç”¨taskæ‰§è¡Œ>
ä½¿ç”¨TASKæ‰§è¡Œ
<a href=#%e4%bd%bf%e7%94%a8task%e6%89%a7%e8%a1%8c class=h-anchor aria-hidden=true>#</a>
</h2>
<p>å¯ä»¥ç›´æ¥é…ç½®ä¸Šé¢çš„è¯­å¥ä¸ºVSCodeçš„taskï¼Œä¸‹è½½æºç å®‰è£…ä¾èµ–ä¹‹åç›´æ¥<code>run task</code>å³å¯ç›´æ¥ç¼–è¯‘è¿è¡Œ</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#75715e>// æ›¿æ¢è‡ªå·±çš„è·¯å¾„
</span><span style=color:#75715e></span>{
  <span style=color:#75715e>// See https://go.microsoft.com/fwlink/?LinkId=733558
</span><span style=color:#75715e></span>  <span style=color:#75715e>// for the documentation about the tasks.json format
</span><span style=color:#75715e></span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;2.0.0&#34;</span>,
  <span style=color:#f92672>&#34;tasks&#34;</span>: [
    {
      <span style=color:#f92672>&#34;label&#34;</span>: <span style=color:#e6db74>&#34;build env&#34;</span>,
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;shell&#34;</span>,
      <span style=color:#f92672>&#34;command&#34;</span>:[
        <span style=color:#e6db74>&#34;mkdir -p /home/vscode/build/making &amp;&amp; &#34;</span>,
        <span style=color:#e6db74>&#34;cd /home/vscode/build/making &amp;&amp; &#34;</span>,
        <span style=color:#e6db74>&#34;/workspaces/postgres/configure  --prefix=/home/vscode/build &amp;&amp; &#34;</span>,
        <span style=color:#e6db74>&#34;make &amp;&amp; &#34;</span>,
        <span style=color:#e6db74>&#34;make install&#34;</span>
      ]
    },
    {
      <span style=color:#f92672>&#34;label&#34;</span>: <span style=color:#e6db74>&#34;pg_start&#34;</span>,
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;shell&#34;</span>,
      <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;/home/vscode/build/bin/pg_ctl -D /home/vscode/data  start&#34;</span>,
    },
    {
      <span style=color:#f92672>&#34;label&#34;</span>: <span style=color:#e6db74>&#34;pg_stop&#34;</span>,
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;shell&#34;</span>,
      <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;/home/vscode/build/bin/pg_ctl -D /home/vscode/data  stop&#34;</span>,
    }
  ]
}
</code></pre></div><p>ç¼–è¯‘å®Œæˆä¹‹åå¦‚æœæ‰§è¡ŒpsqlæŠ¥é”™æ²¡æœ‰vscode&mldr;å¯ä»¥æ‰§è¡Œ<code>createdb vscode</code>å³å¯ï¼Œä¹‹åå¯ä»¥æ­£å¸¸ä½¿ç”¨</p>
<h2 id=ä½¿ç”¨vscodeè°ƒè¯•>
ä½¿ç”¨VSCodeè°ƒè¯•
<a href=#%e4%bd%bf%e7%94%a8vscode%e8%b0%83%e8%af%95 class=h-anchor aria-hidden=true>#</a>
</h2>
<p>å¯ä»¥ä½¿ç”¨VSCodeè¿›è¡Œè°ƒè¯•ï¼Œåªéœ€è¦é…ç½®<code>launch.json</code>å³å¯ã€‚ç„¶åä½¿ç”¨<code>psql</code>æ‰§è¡Œè¯­å¥ï¼Œä½¿ç”¨<code>select pg_backend_pid();</code>æŸ¥è¯¢backendçš„pidï¼Œç›´æ¥attachå³å¯<br>
æ–‡ä»¶å¦‚ä¸‹ï¼Œprogramçš„è·¯å¾„ä¸º<code>postgres</code>çš„è·¯å¾„ï¼Œå¦‚æœæƒ³è¦è°ƒè¯•å…¶ä»–è¿›ç¨‹ï¼Œåˆ™éœ€è¦é…ç½®å¤šä¸ªä»»åŠ¡ï¼Œ</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#75715e>// ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚ 
</span><span style=color:#75715e></span>  <span style=color:#75715e>// æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚
</span><span style=color:#75715e></span>  <span style=color:#75715e>// æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387
</span><span style=color:#75715e></span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
  <span style=color:#f92672>&#34;configurations&#34;</span>: [
    {
      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;(gdb) é™„åŠ &#34;</span>,
      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;cppdbg&#34;</span>,
      <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;attach&#34;</span>,
      <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;/usr/local/pgsql/bin/postgres&#34;</span>,
      <span style=color:#f92672>&#34;processId&#34;</span>: <span style=color:#e6db74>&#34;${command:pickProcess}&#34;</span>,
      <span style=color:#f92672>&#34;MIMode&#34;</span>: <span style=color:#e6db74>&#34;gdb&#34;</span>,
      <span style=color:#f92672>&#34;setupCommands&#34;</span>: [
          {
              <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;ä¸º gdb å¯ç”¨æ•´é½æ‰“å°&#34;</span>,
              <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;-enable-pretty-printing&#34;</span>,
              <span style=color:#f92672>&#34;ignoreFailures&#34;</span>: <span style=color:#66d9ef>true</span>
          },
          {
              <span style=color:#f92672>&#34;description&#34;</span>:  <span style=color:#e6db74>&#34;å°†åæ±‡ç¼–é£æ ¼è®¾ç½®ä¸º Intel&#34;</span>,
              <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;-gdb-set disassembly-flavor intel&#34;</span>,
              <span style=color:#f92672>&#34;ignoreFailures&#34;</span>: <span style=color:#66d9ef>true</span>
          }
      ]
    }
  ]
}
</code></pre></div><h2 id=ä½¿ç”¨docker>
ä½¿ç”¨Docker
<a href=#%e4%bd%bf%e7%94%a8docker class=h-anchor aria-hidden=true>#</a>
</h2>
<p>vscode å®‰è£…<code>Remote - Containers</code>æ’ä»¶ä¹‹åï¼Œå¯ä»¥æ–¹ä¾¿çš„åœ¨dockerä¸­è¿›è¡Œå¼€å‘ï¼Œpostgresä¹Ÿå¯ä»¥è¿è¡Œåœ¨dockerä¸­ï¼Œä¸‹è½½æºç ä¹‹åï¼Œvscodeæ‰“å¼€é¡¹ç›®ï¼Œ<code>shift-p</code>è¾“å…¥<code>Open Workspace in Containe</code>ï¼Œç„¶åé€‰æ‹©ç³»ç»Ÿå³å¯ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯Ubuntu22ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šé…ç½®ï¼Œä¸Šé¢çš„ä¾‹å­ç›´æ¥æŠ„ï¼Œç„¶åçœ‹çœ‹æˆ‘æœ‰å•¥æ²¡å†™çš„ï¼Œè‡ªå·±æ‘¸ç´¢æ‰§è¡Œä¸‹å°±å¯ä»¥äº†ï¼Œä¹Ÿä¼°è®¡ä¸å·®å•¥äº†ã€‚</p>
<hr>
<h2 id=åˆ†å¸ƒå¼pg>
åˆ†å¸ƒå¼PG
<a href=#%e5%88%86%e5%b8%83%e5%bc%8fpg class=h-anchor aria-hidden=true>#</a>
</h2>
<p>åˆ†å¸ƒå¼PGç‰ˆæœ¬ postgres-xcå’Œpostgres-xlï¼Œæºç å†…éƒ¨ä½¿ç”¨å®æ§åˆ¶ï¼Œç¼–è¯‘åˆ†å¸ƒå¼çš„æ—¶å€™ã€‚éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼ç¯å¢ƒè¿è¡Œï¼Œå®˜ç½‘ä¸Šæœ‰ä¸ªæŒ‡å¯¼æ­¥éª¤å¯ä»¥è¿è¡Œä¸€ä¸ªæç®€é›†ç¾¤ï¼Œä¸”æ˜¯åœ¨å•æœºä¸Šï¼Œä½†æ˜¯æˆ‘æ˜¯ç”¨Ubuntuä¸€ç›´æ— æ³•æ­å»ºæˆåŠŸ</p>
<p>æœ€åä½¿ç”¨dockeræ­å»ºæˆåŠŸï¼Œå…·ä½“çš„æ–‡ä»¶åœ¨<a href=git@github.com:Esoye/postgres-docker.git>è¿™é‡Œ</a>ï¼Œä¸‹è½½ä»“åº“ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨postges-xlï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨postgres-xcï¼Œä¸¤è€…ä¹‹é—´åœ¨ç¼–è¯‘æ–¹å¼ä¸Šæ— å¤ªå¤§åŒºåˆ«</p>
<p>å…·ä½“å‚è€ƒREADME</p>
<p>ç›´æ¥é…ç½®å¥½å¯¹åº”çš„æ–‡ä»¶ä½ç½®ï¼Œç›´æ¥<code>docker-compose up</code>ç„¶åå°±å¯ä»¥å’¬ç€æ‰‹æŒ‡ç”²ç­‰å°±å¯ä»¥äº†ã€‚</p>
<ul>
<li>å…³äºè°ƒè¯•ï¼Œdockerä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œç¦æ­¢äº†å®¹å™¨ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œéœ€è¦åœ¨è¿è¡Œçš„æ—¶å€™æ‰‹åŠ¨æ”¾å¼€ï¼Œå¦åˆ™GDBæ— æ³•æ­£å¸¸è°ƒè¯•ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ææ–™</li>
</ul>
<pre tabindex=0><code>https://docs.docker.com/compose/compose-file/compose-file-v2/#cap_add-cap_drop
https://www.cnblogs.com/davis12/p/14453690.html
https://zhoubofsy.github.io/2019/09/24/linux/gdb-in-docker/

cap_add:
  - ALL
</code></pre><ul>
<li>ç‚ºäº†èª¿è©¦ï¼Œæ˜¯å¦å¯ä»¥å§ä¸€éƒ¨ä»½ç¯€é»å»ºåœ¨ç‰©ç†æ©Ÿä¸Šï¼Œèª¿è©¦çš„æ™‚å€™ç›´æ¥ä½¿ç”¨ç‰©ç†æ©Ÿé€²è¡Œèª¿è©¦ï¼Œé€™æ¨£ä¿ç•™äº†é›†ç¾¤çš„åŠŸèƒ½ï¼Œåˆå¯ä»¥æ“æœ‰è±å¯Œèª¿è©¦çš„æ‰‹æ®µ ï¼Ÿ</li>
</ul>
<blockquote>
<p>ç†è®ºä¸Šå¯è¡Œï¼Œæˆ‘ä¹Ÿè¿›è¡Œäº†å°è¯•ï¼Œä½†æ˜¯æ·»åŠ èŠ‚ç‚¹å¤±è´¥ï¼Œæœ€ç»ˆæ²¡æœ‰æˆåŠŸï¼Œåæ¥æƒ³èµ·æ¥ï¼ŒVSCodeä¸­çš„dockerå¯ä»¥æ­£å¸¸è°ƒè¯•ï¼Œçœ‹æ¥æ˜¯ä»–åšäº†ä¸€äº›ç‰¹æ®Šçš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆç”¨ä»–çš„é»˜è®¤ä½¿ç”¨çš„å®¹å™¨ï¼Œç„¶åæˆåŠŸæ‹‰èµ·é›†ç¾¤ï¼Œä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨vscode attachä¸Šå»ï¼Œä½†æ˜¯åœ¨æˆ‘çš„å¦ä¸€ä¸ªè™šæ‹Ÿæœºä¸­å¤±è´¥äº†ï¼Œå”¯ä¸€çš„å·®åˆ«æ˜¯æˆ‘æˆåŠŸçš„æœºå™¨ä½¿ç”¨çš„æ˜¯WSL2ï¼Œå¤±è´¥çš„ç°è±¡æ˜¯é›†ç¾¤ä¹‹é—´æ— æ³•æ­£ç¡®è¯†åˆ«nodeï¼Œä½†æ˜¯ç½‘ç»œæ˜¯é€šé¡ºçš„ï¼Œè¿™é‡Œæ²¡æœ‰ç»§ç»­è¿›è¡Œæ¢ç©¶ï¼Œå› ä¸ºæˆ‘å·²ç»æœ‰å¯ä»¥ä½¿ç”¨çš„èŠ‚ç‚¹äº†</p>
</blockquote>
<p>å¦‚æœå¯ä»¥æˆåŠŸï¼Œé‚£çš†å¤§æ¬¢å–œï¼Œå¦‚æœä¸è¡Œï¼Œå¯ä»¥å›é€€æœ€æ–°ä¸€ä¸ªæäº¤ï¼Œä¹‹å‰çš„ä¸€ä¸ªæäº¤åŸºæœ¬ä¸€å®šæˆåŠŸï¼Œè¿™é‡Œæœ€å¥½æ³¨æ„æ¸…é™¤ä¹‹å‰çš„dockerçš„æ®‹ç•™ï¼Œä½¿ç”¨ä¸‹é¢çš„è¯­å¥æŸ¥è¯¢ï¼Œç„¶åç›´æ¥removeå°±å¯ä»¥</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>docker images 
docker ps 
docker network
docker volume
</code></pre></div><hr>
<hr>
<h3 id=benchmark>
benchmark
<a href=#benchmark class=h-anchor aria-hidden=true>#</a>
</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown>
Instructions for running BenchmarkSQL on PostgreSQL
---------------------------------------------------

<span style=color:#66d9ef>0.</span> Requirements

    Use of JDK7 is required.

<span style=color:#66d9ef>1.</span> Create the benchmarksql user and a database

    As Unix user postgres use the psql shell to connect to the postgres
    database and issue the CREATE USER and CREATE DATABASE commands.

    [postgres#localhost ~] $ psql postgres
    psql (9.5.2)
    Type &#34;help&#34; for help.

    postgres=# CREATE USER benchmarksql WITH ENCRYPTED PASSWORD &#39;changeme&#39;;
    postgres=# CREATE DATABASE benchmarksql OWNER benchmarksql;
    postgres=# \q
    [postgres#localhost ~] $

<span style=color:#66d9ef>2.</span> Compile the BenchmarkSQL source code

    As your own UNIX user change into the toplevel directory of the
    benchmarksql git repository checkout or the directory that was
    created by unpacking the release tarball/zipfile. Use the ant
    command to compile the code.

    [wieck@localhost ~] $ cd benchmarksql
    [wieck@localhost benchmarksql] $ ant
    Buildfile: /nas1/home/wieck/benchmarksql.git/build.xml

    init:
        [mkdir] Created dir: /home/wieck/benchmarksql/build

    compile:
	[javac] Compiling 11 source files to /home/wieck/benchmarksql/build

    dist:
	[mkdir] Created dir: /home/wieck/benchmarksql/dist
	  [jar] Building jar: /home/wieck/benchmarksql/dist/BenchmarkSQL-5.0.jar
    BUILD SUCCESSFUL
    Total time: 1 second
    [wieck@localhost benchmarksql] $

<span style=color:#66d9ef>3.</span> Create the benchmark configuration file

    Change the the run directory, copy the props.pg file and edit
    the copy to match your system setup and desired scaling.

    [wieck@localhost benchmarksql] $ cd run
    [wieck@localhost run] $ cp props.pg my_postgres.properties
    [wieck@localhost run] $ vi my_postgres.properties
    [wieck@localhost run] $

    Note that the provided example configuration is meant to test
    the functionality of your setupr. That benchmarksql can connect
    to the database and execute transactions. That configuration
    is NOT a benchmark run. To make it into one you need to have a
    configuration that matches your database server size and
    workload. Leave the sizing for now and perform a first functional
    test.

    The BenchmarkSQL database has an initial size of approximately
    100-100MB per configured warehouse. A typical setup would be
    a database of 2-5 times the physical RAM of the server.

    Likewise the number of concurrent database connections (config
    parameter terminals) should be something about 2-6 times the
    number of CPU threads.

    Last but not least benchmark runs are normally done for hours,
    if not days. This is because on the database sizes above it
    will take that long to reach a steady state and make sure that
    all performance relevant functionality of the database, like
    checkpointing and vacuuming, is included in the measurement.

    So you can see that with a modern server, that has 32-256 CPU
    threads and 64-512GBi, of RAM we are talking about thousands of
    warehouses and hundreds of concurrent database connections.

<span style=color:#66d9ef>4.</span> Build the schema and initial database load

    Execute the runDatabaseBuild.sh script with your configuration file.

    [wieck@localhost run]$ ./runDatabaseBuild.sh my_postgres.properties
    # ------------------------------------------------------------
    # Loading SQL file ./sql.common/tableCreates.sql
    # ------------------------------------------------------------
    create table bmsql_config (
    cfg_name    varchar(30) primary key,
    cfg_value   varchar(50)
    );
    create table bmsql_warehouse (
    w_id        integer   not null,
    w_ytd       decimal(12,2),
    [...]
    Starting BenchmarkSQL LoadData

    driver=org.postgresql.Driver
    conn=jdbc:postgresql://localhost:5432/benchmarksql
    user=benchmarksql
    password=***********
    warehouses=30
    loadWorkers=10
    fileLocation (not defined)
    csvNullValue (not defined - using default &#39;NULL&#39;)

    Worker 000: Loading ITEM
    Worker 001: Loading Warehouse      1
    Worker 002: Loading Warehouse      2
    Worker 003: Loading Warehouse      3
    [...]
    Worker 000: Loading Warehouse     30 done
    Worker 008: Loading Warehouse     29 done
    # ------------------------------------------------------------
    # Loading SQL file ./sql.common/indexCreates.sql
    # ------------------------------------------------------------
    alter table bmsql_warehouse add constraint bmsql_warehouse_pkey
    primary key (w_id);
    alter table bmsql_district add constraint bmsql_district_pkey
    primary key (d_w_id, d_id);
    [...]
    vacuum analyze;
    [wieck@localhost run]$

<span style=color:#66d9ef>5.</span> Run the configured benchmark

    [wieck@localhost run]$ ./runBenchmark.sh my_postgres.properties

    The benchmark should run for the number of configured concurrent
    connections (terminals) and the duration or number of transactions.

    The end result of the benchmark will be reported like this:

    01:58:09,081 [Thread-1] INFO   jTPCC : Term-00,
    01:58:09,082 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 179.55
    01:58:09,082 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 329.17
    01:58:09,082 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2016-05-25 01:58:07
    01:58:09,082 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2016-05-25 01:58:09
    01:58:09,082 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 10

    At this point you have a working setup.

<span style=color:#66d9ef>6.</span> Scale the benchmark configuration.

    Change the my_postgres.properties file to the correct scaling
    (number of warehouses and concurrent connections/terminals). Switch
    from using a transaction count to time based:

        runTxnsPerTerminal=0
	runMins=180

    Rebuild the database (if needed) by running

    [wieck@localhost run]$ ./runDatabaseDestroy.sh my_postgres.properties
    [wieck@localhost run]$ ./runDatabaseBuild.sh my_postgres.properties

    Then run the benchmark again.

    Rinse and repeat.

<span style=color:#66d9ef>7.</span> Result report

    BenchmarkSQL collects detailed performance statistics and (if
    configured) OS performance data. The example configuration file
    defaults to a directory starting with my_result_.

    Use the generateReport.sh DIRECTORY script to create an HTML file
    with graphs. This requires R to be installed, which is beyond the
    scope of this HOW-TO.


</code></pre></div><p>æŒ‰ç…§è¯´æ˜æ–‡æ¡£ç›´æ¥é¡ºåºæ‰§è¡Œå³å¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„pgè¿è¡Œçš„æ—¶å€™é…ç½®æ–‡ä»¶ä¸­connæŒ‡å®šçš„databaseï¼Œéœ€è¦å’Œå‰é¢è¦æ±‚æ‰§è¡Œçš„è¯­å¥çš„databaseä¸€æ ·ï¼Œ</p>
<p>benchmarkå¦‚æœéœ€è¦æœ‰æ•ˆæµ‹è¯•ï¼Œéœ€è¦æ³¨æ„æ ¹æ®æµ‹è¯•ç¯å¢ƒè®¾ç½®å¯¹åº”çš„å‚æ•°ï¼Œ</p>
<ol>
<li>warehouse
BenchmarkSQLæ•°æ®åº“æ¯ä¸ªwarehouseå¤§å°å¤§æ¦‚æ˜¯100MBï¼Œå¦‚æœè¯¥å‚æ•°è®¾ç½®ä¸º10ï¼Œé‚£æ•´ä¸ªæ•°æ®åº“çš„å¤§å°å¤§æ¦‚åœ¨1000MBã€‚å»ºè®®å°†æ•°æ®åº“çš„å¤§å°è®¾ç½®ä¸ºæœåŠ¡å™¨ç‰©ç†å†…å­˜çš„2-5å€ï¼Œå¦‚æœæœåŠ¡å™¨å†…å­˜ä¸º16GBï¼Œé‚£ä¹ˆwarehouseè®¾ç½®å»ºè®®åœ¨328ï½819ä¹‹é—´ã€‚</li>
<li>terminals
terminalsæŒ‡çš„æ˜¯å¹¶å‘è¿æ¥æ•°ï¼Œå»ºè®®è®¾ç½®ä¸ºæœåŠ¡å™¨CPUæ€»çº¿ç¨‹æ•°çš„2-6å€ã€‚å¦‚æœæœåŠ¡å™¨ä¸ºåŒæ ¸16çº¿ç¨‹ï¼ˆå•æ ¸8çº¿ç¨‹ï¼‰ï¼Œé‚£ä¹ˆå»ºè®®é…ç½®åœ¨32ï½96ä¹‹é—´</li>
<li>runTxnsPerTerminal
æ¯ä¸ªç»ˆç«¯ï¼ˆterminalï¼‰è¿è¡Œçš„å›ºå®šäº‹åŠ¡æ•°é‡ï¼Œä¾‹å¦‚ï¼šå¦‚æœè¯¥å€¼è®¾ç½®ä¸º10ï¼Œæ„å‘³ç€æ¯ä¸ªterminalè¿è¡Œ10ä¸ªäº‹åŠ¡ï¼Œå¦‚æœæœ‰32ä¸ªç»ˆç«¯ï¼Œé‚£æ•´ä½“è¿è¡Œ320ä¸ªäº‹åŠ¡åï¼Œæµ‹è¯•ç»“æŸã€‚è¯¥å‚æ•°é…ç½®ä¸ºé0å€¼æ—¶ï¼Œä¸‹é¢çš„runMinså‚æ•°å¿…é¡»è®¾ç½®ä¸º0</li>
<li>runMins
è¦æµ‹è¯•çš„æ•´ä½“æ—¶é—´ï¼Œå•ä½ä¸ºåˆ†é’Ÿï¼Œå¦‚æœrunMinsè®¾ç½®ä¸º60ï¼Œé‚£ä¹ˆæµ‹è¯•æŒç»­1å°æ—¶å€™ç»“æŸã€‚è¯¥å€¼è®¾ç½®ä¸ºé0å€¼æ—¶ï¼ŒrunTxnsPerTerminalå‚æ•°å¿…é¡»è®¾ç½®ä¸º0ã€‚è¿™ä¸¤ä¸ªå‚æ•°ä¸èƒ½åŒæ—¶è®¾ç½®ä¸ºæ­£æ•´æ•°ï¼Œå¦‚æœè®¾ç½®å…¶ä¸­ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªå¿…é¡»ä¸º0ï¼Œä¸»è¦åŒºåˆ«æ˜¯runMinså®šä¹‰æ—¶é—´é•¿åº¦æ¥æ§åˆ¶æµ‹è¯•æ—¶é—´ï¼›runTxnsPerTerminalå®šä¹‰äº‹åŠ¡æ€»æ•°æ¥æ§åˆ¶æ—¶é—´</li>
<li>limitTxnsPerMin
æ¯åˆ†é’Ÿäº‹åŠ¡æ€»æ•°é™åˆ¶ï¼Œè¯¥å‚æ•°ä¸»è¦æ§åˆ¶æ¯åˆ†é’Ÿå¤„ç†çš„äº‹åŠ¡æ•°ï¼Œäº‹åŠ¡æ•°å—terminalså‚æ•°çš„å½±å“ï¼Œå¦‚æœterminalsæ•°é‡å¤§äºlimitTxnsPerMinå€¼ï¼Œæ„å‘³ç€å¹¶å‘æ•°å¤§äºæ¯åˆ†é’Ÿäº‹åŠ¡æ€»æ•°ï¼Œè¯¥å‚æ•°ä¼šå¤±æ•ˆï¼Œæƒ³æƒ³ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¦‚æœæœ‰1000ä¸ªå¹¶å‘åŒæ—¶å‘èµ·ï¼Œé‚£æ¯åˆ†é’Ÿäº‹åŠ¡æ•°è®¾ç½®ä¸º300å°±æ²¡æ„ä¹‰äº†ï¼Œä¸Šæ¥å°±æ˜¯1000ä¸ªå¹¶å‘ï¼Œæ‰€ä»¥è¦è®©è¯¥å‚æ•°æœ‰æ•ˆï¼Œå¯ä»¥è®¾ç½®æ•°é‡å¤§äºå¹¶å‘æ•°ï¼Œæˆ–è€…è®©å…¶å¤±æ•ˆï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­ç›®å‰é‡‡ç”¨çš„æ˜¯é»˜è®¤300</li>
</ol>
<p>æµ‹è¯•è¿‡ç¨‹ä¸­çš„æ•´ä½“é€»è¾‘é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼šå‡å¦‚limitTxnsPerMinå‚æ•°ä½¿ç”¨é»˜è®¤300ï¼Œtermnalsç»ˆç«¯æ•°é‡è®¾ç½®ä¸º150å¹¶å‘ï¼Œå®é™…ä¼šè®¡ç®—ä¸€ä¸ªå€¼A=limitTxnsPerMin/terminals=2ï¼ˆæ­¤å¤„éœ€è¦æ³¨æ„ï¼ŒAä¸ºintç±»å‹ï¼Œå¦‚æœterminalsçš„å€¼å¤§äºlimitTxnsPerMinï¼Œå¾—åˆ°çš„Aå€¼å¿…ç„¶ä¸º0ï¼Œä¸º0æ—¶è¯¥å‚æ•°å¤±æ•ˆï¼‰ï¼Œæ­¤å¤„è®°ä½A=2ï¼›æ¥ä¸‹æ¥ï¼Œåœ¨æ•´ä¸ªæµ‹è¯•è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè½¯ä»¶ä¼šè®°å½•ä¸€ä¸ªäº‹åŠ¡çš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œå‡è®¾ä¸ºB=2000æ¯«ç§’ï¼›ç„¶åç”¨60000ï¼ˆæ¯«ç§’ï¼Œä»£è¡¨1åˆ†é’Ÿï¼‰é™¤ä»¥Aå¾—åˆ°ä¸€ä¸ªå€¼C=60000/2=30000ï¼Œå‡å¦‚äº‹åŠ¡è¿è¡Œæ—¶é—´B&lt;Cï¼Œé‚£ä¹ˆè¯¥äº‹åŠ¡æ‰§è¡Œå®Œåï¼Œsleep C-Bç§’å†å¼€å¯ä¸‹ä¸€ä¸ªäº‹åŠ¡ï¼›å‡å¦‚B>Cï¼Œæ„å‘³ç€äº‹åŠ¡è¶…è¿‡äº†é¢„æœŸæ—¶é—´ï¼Œé‚£ä¹ˆé©¬ä¸Šè¿›è¡Œä¸‹ä¸€ä¸ªäº‹åŠ¡ã€‚åœ¨æœ¬ä¾‹å­ä¸­ï¼Œæ¯åˆ†é’Ÿ300ä¸ªäº‹åŠ¡ï¼Œè®¾ç½®äº†150ä¸ªå¹¶å‘ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œ2ä¸ªå¹¶å‘ï¼Œæ¯ä¸ªå¹¶å‘æ‰§è¡Œ2ç§’é’Ÿå®Œæˆï¼Œæ¯ä¸ªå¹¶å‘sleep 28ç§’ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸€åˆ†é’Ÿæœ‰ä¸¤ä¸ªå¹¶å‘ï¼Œåæ¨å›æ¥æ•´ä½“å¹¶å‘æ•°ä¸º300/åˆ†é’Ÿ</p>
<p>ä»¥ä¸Šå†…å®¹æ¥è‡ªç½‘ç»œï¼Œè‡ªå·±æµ‹è¯•çš„æ—¶å€™å¯ä»¥ä»”ç»†é˜…è¯»</p>
<pre tabindex=0><code class=language-log data-lang=log>00:58:41,849 [main] INFO   jTPCC : Term-00,
00:58:41,851 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+
00:58:41,851 [main] INFO   jTPCC : Term-00,      BenchmarkSQL v5.0
00:58:41,851 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+
00:58:41,851 [main] INFO   jTPCC : Term-00,  (c) 2003, Raul Barbosa
00:58:41,851 [main] INFO   jTPCC : Term-00,  (c) 2004-2016, Denis Lussier
00:58:41,852 [main] INFO   jTPCC : Term-00,  (c) 2016, Jan Wieck
00:58:41,852 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+
00:58:41,852 [main] INFO   jTPCC : Term-00,
00:58:41,859 [main] INFO   jTPCC : Term-00, db=postgres
00:58:41,859 [main] INFO   jTPCC : Term-00, driver=org.postgresql.Driver
00:58:41,859 [main] INFO   jTPCC : Term-00, conn=jdbc:postgresql://127.0.0.1:65022/benchmarksql
00:58:41,859 [main] INFO   jTPCC : Term-00, user=benchmarksql
00:58:41,859 [main] INFO   jTPCC : Term-00,
00:58:41,859 [main] INFO   jTPCC : Term-00, warehouses=5
00:58:41,860 [main] INFO   jTPCC : Term-00, terminals=1
00:58:41,863 [main] INFO   jTPCC : Term-00, runMins=10
00:58:41,863 [main] INFO   jTPCC : Term-00, limitTxnsPerMin=0
00:58:41,864 [main] INFO   jTPCC : Term-00, terminalWarehouseFixed=true
00:58:41,864 [main] INFO   jTPCC : Term-00,
00:58:41,864 [main] INFO   jTPCC : Term-00, newOrderWeight=45
00:58:41,864 [main] INFO   jTPCC : Term-00, paymentWeight=43
00:58:41,864 [main] INFO   jTPCC : Term-00, orderStatusWeight=4
00:58:41,864 [main] INFO   jTPCC : Term-00, deliveryWeight=4
00:58:41,864 [main] INFO   jTPCC : Term-00, stockLevelWeight=4
00:58:41,864 [main] INFO   jTPCC : Term-00,
00:58:41,864 [main] INFO   jTPCC : Term-00, resultDirectory=my_result_%tY-%tm-%td_%tH%tM%tS
00:58:41,864 [main] INFO   jTPCC : Term-00, osCollectorScript=./misc/os_collector_linux.py
00:58:41,864 [main] INFO   jTPCC : Term-00,
00:58:41,875 [main] INFO   jTPCC : Term-00, copied my_postgres.properties to my_result_2022-09-16_005841/run.properties
00:58:41,879 [main] INFO   jTPCC : Term-00, created my_result_2022-09-16_005841/data/runInfo.csv for runID 77
00:58:41,880 [main] INFO   jTPCC : Term-00, writing per transaction results to my_result_2022-09-16_005841/data/result.csv
00:58:41,881 [main] INFO   jTPCC : Term-00, osCollectorScript=./misc/os_collector_linux.py
00:58:41,881 [main] INFO   jTPCC : Term-00, osCollectorInterval=1
00:58:41,881 [main] INFO   jTPCC : Term-00, osCollectorSSHAddr=null
00:58:41,881 [main] INFO   jTPCC : Term-00, osCollectorDevices=net_eth0 blk_sda
00:58:41,892 [main] INFO   jTPCC : Term-00,
00:58:41,954 [main] INFO   jTPCC : Term-00, C value for C_LAST during load: 129
00:58:41,955 [main] INFO   jTPCC : Term-00, C value for C_LAST this run:    20
00:58:41,955 [main] INFO   jTPCC : Term-00,
Term-00, Running Average tpmTOTAL: 2650.07    Current tpmTOTAL: 172836    Memory Usage: 120MB / 396MB
01:08:41,999 [Thread-1] INFO   jTPCC : Term-00,
01:08:42,001 [Thread-1] INFO   jTPCC : Term-00,
01:08:42,002 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 1211.77
01:08:42,002 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 2650.05
01:08:42,003 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2022-09-16 00:58:41
01:08:42,003 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2022-09-16 01:08:41
01:08:42,003 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 26500
commit 482a0dad010fdbf124a1e92762c77177a59a44e0 (HEAD -&gt; ADB6_2_STABLE_HZ_TEST_FORMAL)
Author: shenduo &lt;734194486@qq.com&gt;
Date:   Thu Jun 2 09:46:45 2022 +0800
    ç”±äºåˆå§‹åŒ–é—®é¢˜ï¼Œæš‚æ—¶å»æ‰éƒ¨åˆ†sql
æ²¡æœ‰FQSä¼˜åŒ–æäº¤ï¼Œæ²¡æœ‰ç‰¹æ®Šé…ç½®
-----------------------------------------------------------------

10:22:00,812 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 1688.86
10:22:00,813 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 3732.81
10:22:00,813 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2022-09-15 10:12:00
10:22:00,813 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2022-09-15 10:22:00
10:22:00,813 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 37328
commit 317f80e466d7e443c4e1a551d4ab03018e64359d (HEAD -&gt; ADB6_2_STABLE_HZ_TEST_FORMAL, origin/ADB6_2_STABLE_HZ_TEST_FORMAL)
Author: maoxp &lt;maoxp@asiainfo.com&gt;
Date:   Fri Sep 9 16:05:31 2022 +0800
    æŠŠFQSåŠ çš„ä¸­æ–‡æ³¨é‡Šä¹±ç ä¿®æ”¹æˆè‹±æ–‡
FQSä¼˜åŒ–ä¹‹åï¼Œæ²¡æœ‰prepareçš„ä¼˜åŒ–ï¼Œæ‰€æœ‰é…ç½®å’Œä¸Šé¢ä¸€æ ·
--------------------------------------------------------------

09:55:47,136 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 1775.56
09:55:47,136 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 3966.71
09:55:47,136 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2022-09-15 09:45:47
09:55:47,136 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2022-09-15 09:55:47
09:55:47,137 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 39667

03:50:41,027 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 1942.16
03:50:41,027 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 4334.52
03:50:41,027 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2022-09-16 03:40:41
03:50:41,027 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2022-09-16 03:50:41
03:50:41,028 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 43345
prepareä¼˜åŒ–ï¼Œåœ¨FQSçš„åŸºç¡€ä¸Šçš„ç»“æœ
</code></pre>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://askyx.github.io/posts/storage/>
<span class=button__icon>â†</span>
<span class=button__text>Postgres Storage</span>
</a>
</span>
<span class="button next">
<a href=https://askyx.github.io/posts/note/>
<span class=button__text>æ•°æ®åº“æ–‡ç« èµ„æºæ±‡æ€»</span>
<span class=button__icon>â†’</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<a href=https://askyx.github.io/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Asky</span>
<span class=logo__cursor></span>
</a>
<div class=copyright>
<span>Â© 2024 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span>
</div>
</div>
</footer>
<script src=https://askyx.github.io/assets/main.js></script>
<script src=https://askyx.github.io/assets/prism.js></script>
</div>
</body>
</html>