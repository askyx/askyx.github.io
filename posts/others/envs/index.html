<!doctype html><html lang=en>
<head>
<title>
Envs ::
Esoye — My note blog
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="hugo #  wget https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb https://github.91chi.fun/https://github.com//gohugoio/hugo/releases/download/v0.92.2/hugo_extended_0.92.2_Linux-64bit.deb sudo dpkg -i hugo*.deb
140.82.113.3
aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
可以使用aria2下载，ubuntu使用apt install aria2直接安装工具，使用-s开启多路下载 aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
manager用户
https://www.jianshu.com/p/a76a93e8c662
Unix #  分区问题，集群上多块磁盘分区挂载到指定目录
fdisk disk 可以对一个磁盘进行分区的添加和删除等操作 p d w h 添加磁盘挂载
lsblk -f 查看磁盘 mkfs.xfs -f -n ftype=1 /dev/sdb1 格式化磁盘 mount /dev/sdb1 /var/lib/docker 挂载 xfs_info /dev/sdb1 | grep ftype=1 blkid /dev/sdb1 查看UUID UUID=&amp;lt;UUID&amp;gt; /var/lib/docker xfs defaults 0 0 写进/etc/fstab 问题Couldn't find device with uuid 4mhUbb-Ls1h-jp0d-JuJK-C38V-T3tX-f7s2IN">
<meta name=keywords content="数据库">
<meta name=robots content="noodp">
<link rel=canonical href=https://select1fromdual.github.io/posts/others/envs/>
<link rel=stylesheet href=https://select1fromdual.github.io/assets/style.css>
<link rel=stylesheet href=https://select1fromdual.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://select1fromdual.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://select1fromdual.github.io/img/favicon.png>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://select1fromdual.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Envs">
<meta name=twitter:description content="hugo #  wget https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb https://github.91chi.fun/https://github.com//gohugoio/hugo/releases/download/v0.92.2/hugo_extended_0.92.2_Linux-64bit.deb sudo dpkg -i hugo*.deb
140.82.113.3
aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
可以使用aria2下载，ubuntu使用apt install aria2直接安装工具，使用-s开启多路下载 aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
manager用户
https://www.jianshu.com/p/a76a93e8c662
Unix #  分区问题，集群上多块磁盘分区挂载到指定目录
fdisk disk 可以对一个磁盘进行分区的添加和删除等操作 p d w h 添加磁盘挂载
lsblk -f 查看磁盘 mkfs.xfs -f -n ftype=1 /dev/sdb1 格式化磁盘 mount /dev/sdb1 /var/lib/docker 挂载 xfs_info /dev/sdb1 | grep ftype=1 blkid /dev/sdb1 查看UUID UUID=<UUID> /var/lib/docker xfs defaults 0 0 写进/etc/fstab 问题Couldn't find device with uuid 4mhUbb-Ls1h-jp0d-JuJK-C38V-T3tX-f7s2IN">
<meta property="og:title" content="Envs">
<meta property="og:description" content="hugo #  wget https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb https://github.91chi.fun/https://github.com//gohugoio/hugo/releases/download/v0.92.2/hugo_extended_0.92.2_Linux-64bit.deb sudo dpkg -i hugo*.deb
140.82.113.3
aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
可以使用aria2下载，ubuntu使用apt install aria2直接安装工具，使用-s开启多路下载 aria2c -s 5 https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb
manager用户
https://www.jianshu.com/p/a76a93e8c662
Unix #  分区问题，集群上多块磁盘分区挂载到指定目录
fdisk disk 可以对一个磁盘进行分区的添加和删除等操作 p d w h 添加磁盘挂载
lsblk -f 查看磁盘 mkfs.xfs -f -n ftype=1 /dev/sdb1 格式化磁盘 mount /dev/sdb1 /var/lib/docker 挂载 xfs_info /dev/sdb1 | grep ftype=1 blkid /dev/sdb1 查看UUID UUID=<UUID> /var/lib/docker xfs defaults 0 0 写进/etc/fstab 问题Couldn't find device with uuid 4mhUbb-Ls1h-jp0d-JuJK-C38V-T3tX-f7s2IN">
<meta property="og:type" content="article">
<meta property="og:url" content="https://select1fromdual.github.io/posts/others/envs/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-02-21T19:00:25+08:00">
<meta property="article:modified_time" content="2022-02-21T19:00:25+08:00"><meta property="og:site_name" content="Esoye">
</head>
<body class=light-theme>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Esoye</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/archive>Archive</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/archive>Archive</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>Envs</h1>
<div class=post-meta>
<span class=post-date>
2022-02-21
</span>
</div>
<div class=post-content>
<h2 id=hugo>
hugo
<a href=#hugo class=h-anchor aria-hidden=true>#</a>
</h2>
<p>wget <a href=https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb>https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb</a>
<a href=https://github.91chi.fun/https://github.com//gohugoio/hugo/releases/download/v0.92.2/hugo_extended_0.92.2_Linux-64bit.deb>https://github.91chi.fun/https://github.com//gohugoio/hugo/releases/download/v0.92.2/hugo_extended_0.92.2_Linux-64bit.deb</a>
sudo dpkg -i hugo*.deb</p>
<p>140.82.113.3</p>
<p>aria2c -s 5 <a href=https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb>https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb</a></p>
<p><a href=https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb>https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb</a></p>
<p>可以使用aria2下载，ubuntu使用<code>apt install aria2</code>直接安装工具，使用-s开启多路下载
aria2c -s 5 <a href=https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb>https://github.com/gohugoio/hugo/releases/download/v0.92.1/hugo_0.92.1_Linux-64bit.deb</a></p>
<p>manager用户</p>
<p><a href=https://www.jianshu.com/p/a76a93e8c662>https://www.jianshu.com/p/a76a93e8c662</a></p>
<h2 id=unix>
Unix
<a href=#unix class=h-anchor aria-hidden=true>#</a>
</h2>
<p>分区问题，集群上多块磁盘分区挂载到指定目录</p>
<pre tabindex=0><code>fdisk disk 可以对一个磁盘进行分区的添加和删除等操作
p 
d
w
h
</code></pre><p>添加磁盘挂载</p>
<pre tabindex=0><code>lsblk -f 查看磁盘
mkfs.xfs -f -n ftype=1 /dev/sdb1 格式化磁盘
mount /dev/sdb1 /var/lib/docker  挂载
xfs_info /dev/sdb1 | grep ftype=1
blkid /dev/sdb1                  查看UUID
UUID=&lt;UUID&gt; /var/lib/docker xfs defaults 0 0 写进/etc/fstab
</code></pre><p>问题<code>Couldn't find device with uuid 4mhUbb-Ls1h-jp0d-JuJK-C38V-T3tX-f7s2IN</code></p>
<p>原因未知，疑似但是这个UUID是前面挂载的分区格式化之前的UUID，所以可能是挂载的时候出了什么问题，但是之前对其他机器操作无问题，此问题只出现在集群中的一两太机器上。</p>
<p>解决：</p>
<pre tabindex=0><code>使用 vgreduce --removemissing --verbose lvname 解决，但是需要视情况而定，需要知道自己在做什么
其中会使用的命令
	lsblk
	vgscan
	pvscan
	cat /etc/lvm/archive/* | less   查看UUID和盘符之前的关系
	
lvextend -L +300G /dev/mapper/centos-root  扩展分区大小
xfs_growfs /dev/mapper/centos-root         扩展且生效
lvremove /dev/mapper/centos-home           删除lv
lvcreate -L 100G -n /dev/mapper/centos-home	创建lv
mkdf.sfx /xxxx								创建文件系统
</code></pre><p>详细储备知识 <a href=https://blog.csdn.net/lemontree1945/article/details/79293390>linux 文件</a></p>
<h2 id=ubuntu安装typora>
Ubuntu安装typora
<a href=#ubuntu%e5%ae%89%e8%a3%85typora class=h-anchor aria-hidden=true>#</a>
</h2>
<p>上海无法直连外网，所以这些都需要翻墙，或者使用其他的链接方式，</p>
<ol>
<li>直接使用snap安装，一般情况下，Ubuntu上可以使用apt安装就使用apt安装，这样节约空间，但是无法使用apt的时候，可以尝试使用snap，不是首选，但是无法链接网络的时候，这是首选方案</li>
<li>使用安装包，但是可能无法下载</li>
<li>添加typora的apt源，使用apt下载，可能有网络问题</li>
</ol>
<h2 id=kubelet-换包>
kubelet 换包
<a href=#kubelet-%e6%8d%a2%e5%8c%85 class=h-anchor aria-hidden=true>#</a>
</h2>
<p><a href=http://docs.kubernetes.org.cn/227.html>官网</a></p>
<h3 id=角色>
角色
<a href=#%e8%a7%92%e8%89%b2 class=h-anchor aria-hidden=true>#</a>
</h3>
<ul>
<li>deployment
*</li>
<li>replicaset</li>
<li>pod</li>
</ul>
<pre tabindex=0><code>docker pull 172.16.1.99/postcommit/inceptor@sha256:d9a8c9c1cf4e1587e2ac468942a987ee43b92c99787f9d392b81a8e1bda26932
docker tag 3b2a1923a5d3 baisheng5:5000/transwarp/argodb-inceptor:argodb-3.2.0-final-wl
docker push baisheng5:5000/transwarp/argodb-inceptor:argodb-3.2.0-final-wl

vdevelop-shiva1-202112141040

kubectl get deployment | grep shiva

172.16.1.99/postcommit/shiva-tabletserver:vdevelop-shiva1-202112141040
172.16.1.99/postcommit/shiva-master:vdevelop-shiva1-202112141040
172.16.1.99/postcommit/shiva-webserver:vdevelop-shiva1-202112141040


</code></pre><p>改变deployment的配置文件的镜像，他会自动重启然后拉取镜像启动服务，所以需要准备自己的镜像，一般只需要替换镜像中的一个或者几个文件，然后让k8s使用此镜像即可，但是无法直接替换镜像中的文件，需要在运行的容器中替换，然后再以此为基准建立新的镜像，然后替换</p>
<p>安装最新gcc g++
<a href=https://www.jianshu.com/p/>https://www.jianshu.com/p/</a>
<a href=https://cloud.tencent.com/developer/article/1635218>https://cloud.tencent.com/developer/article/1635218</a></p>
<h2 id=ubuntu换源>
Ubuntu换源
<a href=#ubuntu%e6%8d%a2%e6%ba%90 class=h-anchor aria-hidden=true>#</a>
</h2>
<pre tabindex=0><code>cd /etc/apt/
sudo cp sources.list sources.list.bak
sudo vim sources.list

sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list

注意换源的版本

deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse

deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse


sudo apt-get update
sudo apt-get upgrade
</code></pre><pre tabindex=0><code>sudo add-apt-repository ppa:ubuntu-toolchain-r/test
sudo apt update

sudo apt install g++-11
sudo apt install gcc-11

</code></pre><p>export GIT_CURL_VERBOSE=1
github无法使用https拉取代码</p>
<ul>
<li>单机docker换源，编辑/etc/docker/daemon.json，配置为</li>
</ul>
<pre tabindex=0><code>{
	&quot;registry-mirrors&quot;: [&quot;https://docker.mirrors.ustc.edu.cn/&quot;]
}
</code></pre><p>然后使用systemctl daemon-reload重新加载配置，使用systemctl restart docker重启docker即可</p>
<p>改变deployment的配置文件的镜像，他会自动重启然后拉取镜像启动服务，所以需要准备自己的镜像，一般只需要替换镜像中的一个或者几个文件，然后让k8s使用此镜像即可，但是无法直接替换镜像中的文件，需要在运行的容器中替换，然后再以此为基准建立新的镜像，然后替换</p>
<h2 id=mysql>
mysql
<a href=#mysql class=h-anchor aria-hidden=true>#</a>
</h2>
<ul>
<li>安装</li>
</ul>
<pre tabindex=0><code>sudo apt install mysql-server
mysql_secure_installation
</code></pre><p>密码问题</p>
<pre tabindex=0><code>/etc/mysql/mysql.conf.d/mysqld.cnf/
添加
skip-grant-tables
然后使用mysql进入mysql
主要修改user下的用户的密码字段
无法直接使用update语句，
可以使用ALTER USER 'root'@'localhost' IDENTIFIED BY '123456'; 修改
如果报权限问题，使用flush privileges;刷新在执行

之后再修改配置文件去掉添加的信息即可

密码策略，
SHOW VARIABLES LIKE 'validate_password%';查看密码策略
使用set global validate_password_length=6;修改策略


</code></pre><h2 id=nodejs-升级>
Nodejs 升级
<a href=#nodejs-%e5%8d%87%e7%ba%a7 class=h-anchor aria-hidden=true>#</a>
</h2>
<p>sudo apt install npm</p>
<p>sudo npm install &ndash;global yarn</p>
<p>yarn create slidev</p>
<p>安装Slidev的时候，需要升级node</p>
<ol>
<li>清除缓存<br>
<code>sudo npm cache clean -f</code></li>
<li>安装版本管理工具<br>
<code>sudo npm install n -g</code></li>
<li>使用版本管理工具安装指定node或者升级到最新node版本<br>
<code>sudo n stable （安装node最新版本</code></li>
</ol>
<p>退出当前session，重新进入，node -v检查</p>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://select1fromdual.github.io/posts/readbooks/%E7%8E%B0%E4%BB%A3c++%E7%99%BD%E7%9A%AE%E4%B9%A6/>
<span class=button__icon>←</span>
<span class=button__text>现代C++白皮书</span>
</a>
</span>
<span class="button next">
<a href=https://select1fromdual.github.io/posts/others/docker/>
<span class=button__text>Docker</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<a href=/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Esoye</span>
<span class=logo__cursor></span>
</a>
<div class=copyright>
<span>© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span>
</div>
</div>
</footer>
<script src=https://select1fromdual.github.io/assets/main.js></script>
<script src=https://select1fromdual.github.io/assets/prism.js></script>
</div>
</body>
</html>